@model QuanLySanXuat.Entities.Account;
@{
    Layout = null;

}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="~/Style/bootstrap.min.css">
    <link rel="stylesheet" href="~/Style/Login.css">
    <link rel="stylesheet" href="~/Style/ListenAndWrite.css">

   

    <title>Log in</title>
</head>

<body>
    <div id="login" class="wrapper fade">
        <div class="mt-2">
            <h3 class="text-center">Hello LogIn</h3>
        </div>
        <form id="register-form" asp-action="Login" asp-controller="Login" method="post" onsubmit="return checkLogin()">
            <input class="d-none" value="login" name="login" />

            <div class="field">
                <input autofocus type="text" name="Email" id="emailLogin">
                <label for="email">Email Address</label>
                <span class="text-danger" id="checkEmailLogin"></span>

            </div>
            <div class="field">
                <input type="password" name="Password" id="passwordLogin">
                <label for="password">Password</label>
                <span class="text-danger" id="checkPasswordLogin"></span>
                @if (TempData["ErrorLogin"] != null)
                {
                    <span class="text-danger">@TempData["ErrorLogin"]</span>

                }
            </div>
            <div class="content mt-2">
                <div class="checkbox">
                    <input type="checkbox" checked name="KeepLoggedIn" id="checkbox">
                    <label for="checkbox">Remember me</label>
                </div>
                <div class="pass-link">
                    <a href="/Login/GetPassword">Forgot password?</a>
                </div>

            </div>
            <div class="field">

                <input type="submit" value="Login">
            </div>
            <div class="signup-link">
                @*<div class="link-social">
                        <p>Or SignUp Using</p>
                        <div class="icon ">
                            <i class="fab fa-facebook"></i>
                            <i class="fab fa-twitter"></i>
                            <i class="fab fa-google-plus"></i>
                        </div>
                    </div>*@
                <div class="link-signup">
                    <p>Or SignUp Using</p>
                    <button id="btn-signupForward" class="btn border-0 text-primary">Sign Up</button>

                </div>
            </div>
        </form>
    </div>
    <div id="signup" class="wrapper fade" style='display: none;'>
        <div class="mt-2">
            <h3 class="text-center">Hello SignUp</h3>
        </div>
        <form id="register-form" asp-action="Register" asp-controller="Login" method="post" onsubmit="return checkSignup()">
            <input class="d-none" value="signup" name="signup" />
            <div class="field">
                <input autofocus type="text" name="Email" id="email">
                <label for="email">Email Address</label>
                @if (TempData["existEmail"] != null)
                {
                    <span class="text-danger">@TempData["existEmail"]</span>

                }
                <span class="text-danger" id="checkEmail"></span>

            </div>
            <div class="field">
                <input type="password" name="Password" id="password">
                <label for="password">Password</label>
                <span class="text-danger" id="checkPassword"></span>

            </div>
            <div class="field">
                <input type="password" name="confirmPassword" id="confirmPassword">
                <label for="password">Retype Password</label>
                <span class="text-danger" id="checkConfirmPassword"></span>

            </div>

            <div class="field mt-5">
                <input type="submit" value="Signup">
            </div>
            <div class="text-center">
                <button type="button" id="btn-loginForward" class="btn border-0 text-primary">Log In</button>

            </div>
        </form>
    </div>

    <script src="~/Js/ValidateEmail.js"></script>

    <script>

        const checkSignup = function () {
            let issubmit = false;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirmPassword").value;
            const checkConfirmPassword = document.getElementById("checkConfirmPassword");
            const checkPassword = document.getElementById("checkPassword");
            const checkEmail = document.getElementById("checkEmail");
            if (!validateEmail(email)) {
                checkEmail.innerText = "Email is invalid";
            }
            if (password != confirmPassword) {
                checkConfirmPassword.innerText = "Confirm password does not match!";
            }
            if (password.length < 8) {
                checkPassword.innerText = "Please enter at least 8 characters!";
            }
            else if (confirmPassword.length < 8) {
                checkConfirmPassword.innerText = "Please enter at least 8 characters!";
            }
            else {
                issubmit = true;
            }
            return issubmit;
        };

        const checkLogin = function () {
            let issubmit = false;
            const emailLogin = document.getElementById("emailLogin").value;
            const passwordLogin = document.getElementById("passwordLogin").value;
            const checkPasswordLogin = document.getElementById("checkPasswordLogin");
            const checkEmailLogin = document.getElementById("checkEmailLogin");
            if (!validateEmail(emailLogin)) {
                checkEmailLogin.innerText = "Email is invalid";
            }
            if (passwordLogin.length < 8) {
                checkPasswordLogin.innerText = "Please enter at least 8 characters!";
            }
            else {
                issubmit = true;
            }
            return issubmit;
        };
    </script>

    <script>
        function toggleDiv(div) {

            if (div.style.display == "none") {
                div.style.display = "block";
            } else {
                div.style.display = "none";
            }
        }
        const signupForwardBtn = document.getElementById("btn-signupForward");
        const loginForwardBtn = document.getElementById("btn-loginForward");
        const login = document.getElementById("login");
        const signup = document.getElementById("signup");
        signupForwardBtn.addEventListener("click", function () {
            login.style.display = "none";
            signup.style.display = "block";
            document.title = "Sign up";
        });
        loginForwardBtn.addEventListener("click", function () {
            login.style.display = "block";
            signup.style.display = "none";
            document.title = "Log in";

        })
    </script>




    @*<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#loginForm').validate({
                    rules: {
                        email: {
                            required: true,
                            email: true
                        },
                        password: {
                            required: true,
                            minlength: 8
                        }
                    },
                    messages: {
                        email: {
                            required: "Please enter an email address",
                            email: "Please enter a valid email address"
                        },
                        password: {
                            required: "Please enter a password",
                            minlength: "Your password must be at least 8 characters long"
                        }
                    },
                    submitHandler: function (form) {
                        var email = $('#email').val();
                        var password = $('#password').val();

                        $.ajax({
                            url: '/Login/login',
                            method: 'POST',
                            data: {
                                email: email,
                                password: password
                            },
                            dataType: 'json',
                            success: function (data) {
                                // Redirect to home page
                                window.location.href = '/Home/Index';
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                // Handle error
                            }
                        });
                    }

                });
            });

            // Define validation rules and error messages
            $("#register-form").validate({
                rules: {
                    username: "required",
                    email: {
                        required: true,
                        email: true
                    },
                    password: {
                        required: true,
                        minlength: 8
                    },
                    confirmPassword: {
                        required: true,
                        equalTo: "#password"
                    }
                },
                messages: {
                    username: "Vui lòng nhập tên đăng nhập",
                    email: {
                        required: "Vui lòng nhập email",
                        email: "Email không hợp lệ"
                    },
                    password: {
                        required: "Vui lòng nhập mật khẩu",
                        minlength: "Mật khẩu phải có ít nhất 8 ký tự"
                    },
                    confirmPassword: {
                        required: "Vui lòng nhập lại mật khẩu",
                        equalTo: "Mật khẩu không khớp"
                    }
                }
            });

            // Handle form submission
            $("#register-form").submit(function (event) {
                event.preventDefault();

                if ($("#register-form").valid()) {
                    // Submit the form
                    $.ajax({
                        type: "POST",
                        url: "/Login/Register",
                        data: $(this).serialize(),
                        success: function (result) {
                            // Handle successful registration
                            window.location.href = '/Login/Login';
                        },
                        error: function (result) {
                            // Handle registration error
                        }
                    });
                }
            });

        </script>*@

    <script>
        window.addEventListener('beforeunload', function () {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.indexOf('HienCaCookie=') === 0) {
                    document.cookie = "hienca=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                    break;
                }
            }
        });

    </script>
</body>

</html>